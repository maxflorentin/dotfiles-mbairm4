#!/bin/bash

echo "Setting up test project..."

REPOSITORY=$1
DIRECTORY="./$2"

if [[ $PWD != "$HOME/Herd" ]]; then
    echo "You can only setup projects in the $HOME/Herd directory."

    exit 1
fi

if [ -z "$REPOSITORY" ] || [ -z "$DIRECTORY" ]; then
    echo "Please provide both a repository and target directory."

    exit 1
fi

git clone $REPOSITORY $DIRECTORY
cd $DIRECTORY




# Python virtual environment setup
if [ -f "requirements.txt" ]; then
    echo "Setting up Python virtual environment..."
    if command -v uv &> /dev/null; then
        echo "Using uv for virtual environment setup."
        uv venv
        source .venv/bin/activate
        uv pip install -r requirements.txt
    else
        echo "uv not found, falling back to python3 -m venv."
        python3 -m venv .venv
        source .venv/bin/activate
        pip install -r requirements.txt
    fi
fi

open -a "/Applications/Visual Studio Code.app" "`pwd`"
